---
title: "GA6"
author: "Alison Bateman"
date: today 
date-format: long 
format: 
  html:
    theme: cosmo 
    toc: true 
---

## **3 Main assignment:**

### 3.1 R Basics

1.  Create a character vector `fav_food` with five names of your favorite food. Replace third element of the vector with a bird name and extract first and fifth element.

    ```{r}
    fav_food <- c("Sushi", "Chicken Makhani", "Mushroom Ravioli", "Mint Mocha Coffee", "Naan")
    ```

2.  Load the `tidyverse` package. We have seen in the class that when we load the `tidyverse` package, we see many warnings. Use the code chunk option to hide the warning. Read your `metadata.tsv` file from the `garrigos-data/meta` directory and save it as object `metadata`. Write down the data structure of the `metadata`, number of variables, and rows.

    ```{r}
    library(tidyverse)
    ```

    ```{r}
    metadata <- read_tsv(file = "/fs/ess/PAS2880/users/bateman139/garrigos-data/metadata.tsv")



    ```

    ```{r}
    metadata
    ```

    Data structure: tibble (data frame)

    Number of variables: 3

    Number of rows: 22

3.  In the `metadata` object, replace the `dpi` with `_dpi` of the `time` variable and `cathemerium` with `cath` of the `treatment` variable.

    ```{r}
    metadata <- metadata|>
      mutate(
        time = sub(pattern = "dpi", replacement = "_dpi", x = time)
        )
    ```

```{r}
metadata <- metadata|>
  mutate(
    treatment = sub(pattern = "cathemerium", replacement = "cath", x = treatment)
    )
```

```{r}
head(metadata)
```

### 3.2 Data wrangling

Instead of creating new objects, always pipe your output unless explicitly stated.

1.  List all the datasets available in the `ggplot2` package. Read the data from inbuilt- dataset `midwest`. Save it as an object `midwest_datasets` and use the `midwest_datasets` to answer all the question afterwards.

    ```{r}
    library(ggplot2)

    data(package = "ggplot2")
    ```

    ```         
    Data sets in package ‘ggplot2’:  
    diamonds                                     Prices of over 50,000 round cut diamonds
    economics                                    US economic time series
    economics_long                               US economic time series 
    faithfuld                                    2d density estimate of Old Faithful data
    luv_colours                                  'colors()' in Luv space 
    midwest                                      Midwest demographics 
    mpg                                          Fuel economy data from 1999 to 2008 for 38 popular models of cars 
    msleep                                       An updated and expanded version of the mammals sleep dataset 
    presidential                                 Terms of 12 presidents from Eisenhower to Trump 
    seals                                        Vector field of seal movements 
    txhousing                                    Housing sales in TX
    ```

    ```{r}
    midwest_datasets <- midwest

    ```

2.  Filter the rows with `poptotal > 30000` and `popdensity > 800`.

    ```{r}
    str(midwest_datasets)
    ```

```{r}
midwest_datasets |>
  filter(poptotal > 30000, popdensity > 800)
```

3.  Select first 11 variables of the dataset. Create a new column named `asian_ameri` in `midwest_datasets` object by dividing `popasian` by `popamerindian` and sort `asian_ameri` in descending order. Save this output as `new_dataset` object

    ```{r}
     new_dataset <- midwest_datasets |>
      filter(poptotal > 30000, popdensity > 800) |>
      select(1:11) |>
      mutate(asian_ameri = popasian / popamerindian) |>
      arrange(desc(asian_ameri))
     new_dataset
    ```

    4.  Compute the total mean population per state and name the mean column as `poptotal`.

    ```{r}
    new_dataset |>
       group_by(state) |>
      summarise(poptotal = mean(poptotal))
    ```

### 3.3 Quarto and Data Visualization

In our class we created scatter plot, box plot and bar graph. For this assignment, you will create the violin plot by reading the ggplot2 documentation using the `midwest_datasets`.

1.  Create the violin plot with `state` in x-axis and `area` in y-axis. Facet the plot based on the `category`.

    ```{r}
    midwest_datasets |>
      ggplot(aes(x = state, y = area)) +
      geom_violin() +
        facet_wrap(vars(category))
    ```

2.  Create a violin plot again with `state` in x-axis and `poptotal` in y-axis. Add the jitter points on the plot and color just the points based on the `category`. Is this point color global or local mapping? please explain.

```{r}
midwest_datasets |>
  ggplot(aes(x = state, y = poptotal, )) +
  geom_violin() +
  geom_jitter(aes(color=category))
```

```{r}
violin_plot <- midwest_datasets |>
  ggplot(aes(x = state, y = poptotal)) +
  geom_violin(aes(fill = state)) +
  geom_jitter(aes(color = category)) +
  scale_fill_manual(values = c("red", "blue", "green", "orange", "purple")) +
  theme_bw()
```

-   It would be local mapping at `color=category` is inside aes() in geom_jitter(). If it where glocal it would be in ggplot(aes()). The color is only being applied to category. If it were global, it would be applied to everything.

    3.  In the above plot change the theme to `theme_bw` and color the `state` manually instead of using default colors. Add the title of the plot using the **code chunk options**. Save this plot as an object `violin_plot`.

    ```{r}
    violin_plot <- midwest_datasets |>
      ggplot(aes(x = state, y = poptotal)) +
      geom_violin(aes(fill = state)) +
      geom_jitter(aes(color = category)) +
      scale_fill_manual(values = c("red", "blue", "green", "orange", "purple")) +
      theme_bw()
      labs(title = "Violin Plot of Population per State")
    ```

    3.  Export the `violin_plot` and label it as `violoin_plot.png` in your current working repository.

```{r}
ggsave(filename = "violoin_plot.png", plot = violin_plot)
```
